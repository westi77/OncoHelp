# User Guide — OncoHelp

## 1. Назначение системы

OncoHelp — AI-ассистент для анализа соответствия лечения онкологических пациентов клиническим рекомендациям.

Система используется как вспомогательный инструмент для врача и пациента и не заменяет клиническое решение специалиста.

---

## 2. Формат и структура входных данных

### 2.1 Входные параметры

На вход системе передаются:
- роль пользователя: ROLE_doctor или ROLE_patient;
- нозология;
- файл истории болезни пациента.

### 2.2 История болезни

История болезни передаётся в виде файла:
- формат: PDF / DOCX / TXT;
- структура: произвольная;
- язык: русский.

Документ может содержать:
- сведения о диагнозе;
- данные о прошлом лечении;
- данные о текущем лечении;
- сопутствующие состояния;
- сведения о беременности;
- сведения о возрасте пациента.

Используются только обезличенные данные.

---

## 3. Источники клинических рекомендаций

В текущей версии системы используются следующие источники:
- клинические рекомендации Министерства здравоохранения Российской Федерации;
- клинические рекомендации RUSSCO.

Источники применяются:
- строго в рамках переданной нозологии;
- с указанием года утверждения или последней редакции;
- с указанием приказа или официального документа (если применимо).

---

## 4. Архитектура решения

### 4.1 Общая архитектура

Система реализована в виде Telegram-бота с использованием платформы n8n.

Основные модули:
- Telegram-интерфейс;
- модуль извлечения текста из файлов;
- модуль анализа соответствия рекомендациям;
- модуль учёта особых клинических групп;
- диалоговый модуль для уточняющих вопросов;
- хранилище промежуточных результатов анализа.

### 4.2 Поток данных

1. Пользователь загружает файл истории болезни.
2. Система извлекает текст.
3. Используется переданная нозология.
4. Загружаются релевантные клинические рекомендации (Минздрав РФ, RUSSCO).
5. При наличии информации определяется принадлежность к особым клиническим группам.
6. Выполняется анализ соответствия лечения.
7. Формируется отчёт.
8. Результат сохраняется для диалогового режима.

---

## 5. Логика работы системы

Основной анализ выполняется один раз и включает:
- сопоставление прошлого лечения с рекомендациями;
- сопоставление текущего лечения с рекомендациями;
- проверку применимости рекомендаций для пожилых пациентов и беременных пациенток (если указано).

При последующих вопросах пользователя:
- повторный анализ документа не выполняется;
- используются сохранённые результаты анализа;
- в модель передаётся только релевантный контекст и вопрос.

---

## 6. Инструкция по загрузке данных

1. Пользователь запускает Telegram-бота.
2. Выбирает режим работы (врач или пациент).
3. Загружает файл истории болезни.
4. Ожидает завершения анализа.
5. Получает результат в чате.
6. При необходимости задаёт уточняющие вопросы.

---

## 7. Формат выдачи результата

### 7.1 Для врача

Отчёт содержит:
- итоговую оценку соответствия лечения;
- анализ прошлого лечения;
- анализ текущего лечения;
- указание применённых источников рекомендаций;
- учёт особенностей пожилого возраста или беременности (если применимо);
- выявленные несоответствия и ограничения анализа.

### 7.2 Для пациента

Отчёт содержит:
- общее пояснение результатов;
- указание соответствий и проблемных этапов;
- пояснение, если лечение отличается для пожилых пациентов или при беременности;
- информацию, какие вопросы стоит обсудить с врачом;
- указание источников рекомендаций.

---

## 8. Интерпретация результатов

Используются следующие статусы:
- соответствует;
- частично соответствует;
- не соответствует;
- невозможно оценить из-за недостатка данных.

Проценты соответствия отражают долю выполненных обязательных пунктов рекомендаций с учётом клинических особенностей пациента.

---

## 9. Ограничения и область применимости

- анализируется одна нозология за один запуск;
- используются только рекомендации Минздрава РФ и RUSSCO;
- учёт пожилого возраста и беременности возможен только при наличии соответствующих данных;
- качество анализа зависит от полноты входных данных;
- система не предназначена для назначения лечения.

---

## 10. Методология валидации

Валидация прототипа проводится на основе:
- обезличенных историй болезни;
- экспертной проверки корректности анализа с учётом источников рекомендаций и клинических особенностей пациентов.

---

## 11. Метрики качества

Используемые метрики:
- скорость анализа;
- удобство использования;
- воспроизводимость результатов.

---

## 12. Сценарии тестирования

Тестируются следующие сценарии:
- стандартный пациент без особых клинических факторов;
- пожилой пациент;
- беременная пациентка;
- неполная история болезни;
- история с несоответствующим лечением;
- диалоговый сценарий с уточняющими вопросами.
