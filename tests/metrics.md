# Метрики качества системы OncoHelp

В данном разделе описаны метрики, использованные для оценки качества работы прототипа системы **OncoHelp** — AI-ассистента для проверки соответствия лечения онкологических пациентов клиническим рекомендациям.

Оценка проводилась на наборе обезличенных клинических кейсов в рамках ручного тестирования.  
Поскольку система находится на стадии прототипа, результаты представлены в виде доли успешно отработавших тестовых сценариев.

---

## 1. Точность классификации соответствия лечения

**Описание метрики:**  
Доля клинических кейсов, в которых система корректно определяет итоговый статус соответствия лечения клиническим рекомендациям.

Используемые классы:
- соответствует  
- частично соответствует  
- не соответствует  
- невозможно оценить из-за недостатка данных  

**Метод оценки:**  
Сравнение итогового статуса, выданного системой, с эталонной экспертной оценкой для каждого тестового кейса.

**Результат:**  
- Корректная классификация статуса соответствия в **8 из 10 тестовых кейсов**.  
- В оставшихся кейсах выявленные ошибки были связаны с формулировками и обработкой контекста и были устранены в ходе итеративной доработки промптов.

---

## 2. Полнота выявления клинических отклонений

**Описание метрики:**  
Способность системы выявлять клинически значимые отклонения от стандартов лечения, предусмотренных клиническими рекомендациями.

Примеры отклонений:
- отсутствие обязательного этапа терапии;
- использование нерекомендованных препаратов или методов;
- неполный объём лечения;
- противоречивые назначения.

**Метод оценки:**  
Ручная проверка наличия всех ожидаемых отклонений в выводе системы.

**Результат:**  
- Ключевые клинические отклонения были выявлены в **7 из 9 соответствующих тестовых сценариев**.  
- Пропущенные отклонения использовались для уточнения логики анализа и улучшения промпта.

---

## 3. Отсутствие клинических галлюцинаций

**Описание метрики:**  
Частота появления в выводе системы:
- вымышленных назначений;
- нерелевантных молекулярных маркеров;
- рекомендаций, не относящихся к заданной нозологии.

**Метод оценки:**  
Анализ выводов системы на предмет появления нерелевантных или несуществующих клинических данных.

**Результат:**  
- Отсутствие клинических галлюцинаций зафиксировано в **8 из 10 тестовых кейсов**.  
- Выявленные случаи галлюцинаций были устранены в ходе доработки ограничений и источников в промпте.

---

## 4. Устойчивость к формату медицинской документации

**Описание метрики:**  
Способность системы сохранять корректность клинического вывода при различной структуре истории болезни.

Проверяемые форматы:
- сплошной неструктурированный текст;
- структурированные разделы;
- списки и табличные представления.

**Метод оценки:**  
Сравнение клинической сути выводов для одного и того же кейса, представленного в разных форматах.

**Результат:**  
- Сохранение клинической сути вывода в **9 из 10 тестовых кейсов**, представленных в различных форматах.

---

## 5. Корректность извлечения ключевых клинических данных

**Описание метрики:**  
Корректность автоматического извлечения системой ключевых параметров из истории болезни.

Параметры:
- диагноз и нозология;
- стадия и TNM (если указаны);
- проведённое и планируемое лечение;
- принадлежность к особым клиническим группам.

**Метод оценки:**  
Сравнение извлечённых системой данных с исходным текстом истории болезни.

**Результат:**  
- Корректное извлечение ключевых клинических параметров в **8 из 10 тестовых кейсов**.  
- Ошибки извлечения использовались для уточнения правил парсинга и логики анализа.

---

## 6. Стабильность контекста в диалоговом режиме

**Описание метрики:**  
Способность системы корректно отвечать на уточняющие вопросы после основного анализа без изменения ранее выданных выводов.

Проверяемые аспекты:
- сохранение статусов и процентов соответствия;
- отсутствие повторного анализа всей истории болезни;
- отсутствие новых клинических выводов.

**Метод оценки:**  
Серия последовательных вопросов после основного отчёта.

**Результат:**  
- Стабильное сохранение контекста в **7 из 9 диалоговых сценариев**.  
- Выявленные проблемы были связаны с управлением контекстом и снижены в ходе оптимизации.

---

## 7. Корректность ответов на уточняющие вопросы

**Описание метрики:**  
Соответствие ответов системы вопросам пользователя и ранее выданному анализу.

Примеры вопросов:
- «Почему это несоответствие?»  
- «Каких данных не хватает?»  

**Метод оценки:**  
Ручная проверка релевантности и полноты ответов.

**Результат:**  
- Корректные и релевантные ответы получены в **8 из 9 проверенных сценариев**.

---

## 8. Время анализа истории болезни

**Описание метрики:**  
Среднее время формирования полного аналитического отчёта по истории болезни.

**Метод оценки:**  
Замер времени от момента загрузки истории болезни до получения итогового отчёта.

**Результат:**  
- Среднее время анализа одной истории болезни составляет около **14.2 секунд** для пациента и около **19.7 секунд** для врача.

---

## 9. Эффективность использования токенов

**Описание метрики:**  
Отсутствие повторной обработки всей истории болезни при переходе в диалоговый режим.

**Метод оценки:**  
Анализ объёма повторного контекста в серии вопросов после основного отчёта.

**Результат:**  
- Повторная передача полного текста истории болезни в диалоговом режиме не требовалась в **8 из 9 сценариев**, что снижает общее потребление токенов.

---

## Итог

Результаты тестирования показывают, что прототип OncoHelp:
- демонстрирует высокую устойчивость и корректность в большинстве клинических сценариев;
- выявленные ошибки используются для итеративного улучшения системы;
- обладает потенциалом для дальнейшего повышения точности и масштабирования.
